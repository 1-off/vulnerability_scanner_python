import requests
import os
from pprint import pprint as p
import re

targets = []
url = "https://crt.sh/"

def who_is(target:str) -> list:
    out = os.popen(f'whois -H {target}').read()
    nameservers = list()
    for item in out.split('\n'):
        if "Name Server:" in item:
            nameservers.append((item).lower().replace(' ',''))

    print(out.split('\n'))
    dedup = list(set(nameservers))
    return dedup


def dig(target:str):
    out = os.popen(f'dig  +short +noall +answer +multiline {target} any').read()
    return out.split('\t')


def crt(target:str):
    re = requests
    try:
        print(url+f'?q={target}&output=json')
        re = re.get(url+f'?q={target}&output=json')
        return re.json()
    except Exception as e:
        print(e)
        return {"result":"none"}

def netcraft(target:str):
    #todo need to be scraped w b4s
    try:
        re = requests.get(f'https://sitereport.netcraft.com/?url=http://www.google.com#netblock_table')
        print(f'https://sitereport.netcraft.com/?url=https://{target}')
        return re.text
    except:
        pass

if __name__ == '__main__':
    p(who_is('google.com'))
    # p(dig('google.com'))
    # p(netcraft('www.google.com'))
